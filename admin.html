<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Admin | Samaflux</title>
<style>
body{margin:0;font-family:system-ui;background:#f5f7fa}
.card{background:#fff;padding:20px;border-radius:12px;margin:20px}
button{padding:8px 12px;border:none;border-radius:6px;background:#0070ba;color:#fff}
input{padding:8px;width:100%;margin:6px 0}
.row{display:flex;gap:20px}
</style>
</head>

<body>

<div id="login" class="card" style="max-width:360px;margin:80px auto">
<h3>Admin Login</h3>
<input id="email" placeholder="Email">
<input id="password" type="password" placeholder="Password">
<button onclick="login()">Login</button>
</div>

<div id="panel" style="display:none">
<div class="row">
<div class="card">
<h3>Users</h3>
<div id="users"></div>
</div>

<div class="card">
<h3>Transactions</h3>
<div id="tx"></div>
</div>
</div>
</div>

<script>
const API="https://samaflux-backend.onrender.com";

async function login(){
const r=await fetch(API+"/admin/login",{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify({email:email.value,password:password.value})
});
if(r.ok){
login.style.display="none";
panel.style.display="block";
load();
}else alert("Invalid login");
}

async function load(){
const users=await fetch(API+"/admin/users").then(r=>r.json());
usersDiv.innerHTML="";
users.forEach(u=>{
users.innerHTML+=`
<div>
${u.email} | ₦${u.balance || 0}
<button onclick="freeze('${u.email}')">Freeze</button>
<button onclick="unfreeze('${u.email}')">Unfreeze</button>
</div>`;
});

const txs=await fetch(API+"/admin/transactions").then(r=>r.json());
tx.innerHTML="";
txs.forEach(t=>{
tx.innerHTML+=`<div>${t.type} ₦${t.amount}</div>`;
});
}

async function freeze(email){
await fetch(API+"/admin/freeze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email})});
load();
}

async function unfreeze(email){
await fetch(API+"/admin/unfreeze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email})});
load();
}
</script>

</body>
</html>
